{% extends "cookbook_app/main.html" %}
{% load i18n %}
{% load static %}

{% block content %}
    <div class="container col-5">
        <div class=" d-flex justify-content-between align-items-center">
            <h1 class=>{% trans "Recipes" %}</h1>
            <form id="search-form" class="form-inline">
                <div class="input-group">
                    <input id="search-input" class="form-control" type="search" name="recipes_query"
                           placeholder="Search recipes"
                           aria-label="Search">
                    <button class="btn btn-primary" type="submit"><i class="bi bi-search"></i></button>
                    <button class="btn btn-secondary ms-1" id="tags-toggle"><i class="bi bi-hash"></i></button>
                </div>
            </form>
            <a href="{% url "admin:cookbook_app_recipe_add" %}" target="_blank" class="btn btn-link">
                <span class="bi bi-file-earmark-plus fs-2"></span>
            </a>

        </div>
        <div id="tags-list" class="d-none">
            {% include 'cookbook_app/tags.html' with tags=all_tags %}
        </div>
        <div id="recipe-list">
            {% include "cookbook_app/recipes_list.html" %}
        </div>
    </div>

    <script>
        // Handle search form submission via AJAX
        const searchForm = document.getElementById("search-form");
        const searchInput = document.getElementById("search-input");
        const recipeList = document.getElementById("recipe-list");

        searchForm.addEventListener("submit", function (event) {
            event.preventDefault();
            const query = searchInput.value;

            fetch("{% url 'search_recipes' %}?query=" + encodeURIComponent(query))
                .then(response => response.text())
                .then(html => {
                    recipeList.innerHTML = html;
                })
                .catch(error => {
                    console.error("Error:", error);
                });
        });
    </script>
    <script src="{% static 'js/recipes.js' %}"></script>
{% endblock %}